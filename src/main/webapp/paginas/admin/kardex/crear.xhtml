<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"                
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:s="http://jboss.org/seam/faces"
                xmlns:ocp="http://java.sun.com/jsf/composite/ocpcommon"
                xmlns:mtop="http://mtop.org/jsf/facelets"
                template="/WEB-INF/templates/plantilla.xhtml">

    <ui:param name="titulo" value="Kardex"/>
    <f:metadata>
        <f:viewParam id="kardexx" name="kardexId" value="#{controladorKardex.kardexId}"/>
        <f:viewParam id="vistaaa" name="valorVista" value="#{controladorKardex.vista}"/>

    </f:metadata>
    <ui:define name="header">

        #{titulo}

    </ui:define>
    <ui:define name="content">

        <h:form id="form">
            <div role="main">
                <div class="container-content" style="margin: 2em 10em 6em 10em; " align="left">
                    <div align="right">    

                        <p:button rendered="#{controladorKardex.vista eq 'kardex'}"
                                  icon="ui-icon-arrowreturnthick-1-w" value="Regresar" 
                                  outcome="/paginas/admin/kardex/lista"
                                  styleClass="btn  btn-success"/>
                    </div><br/>
                    <p:panel id="infovehiculo" rendered="#{controladorKardex.vista eq 'kardex'}">

                        <div class="panel panel-primary">
                            <div class="panel-heading" align="center">ESPECIFICACIÓNES TÉCNICAS DEL VEHÍCULO</div>
                            <p:panel >
                                <div class="container-fluid" align="center">
                                    <div class="row-fluid"  >
                                        <div class="col-md-4"> 
                                            <h:outputLabel class="navbar-text" value=" Registro:"/>
                                            <h:outputText class="navbar-text" value="#{controladorKardex.instance.vehiculo.numRegistro}"/>

                                        </div>
                                        <div class="col-md-4"> 
                                            <h:outputLabel class="navbar-text" value=" Número de Chasis: "/>

                                            <c:forEach items="#{ui.getProperties(controladorKardex.instance.vehiculo)}" var="p" >
                                                <c:if test="#{p.type == 'org.mtop.modelo.dinamico.Structure' and p.name =='Chasis'}">
                                                    <ui:repeat value="#{controladorKardex.instance.vehiculo.findBussinesEntityAttribute(p.name)}" var="a" varStatus="status"> 
                                                        <h:outputText rendered="#{a.name =='serie'}" class="navbar-text" value="#{a.value}" ></h:outputText>
                                                    </ui:repeat>
                                                </c:if>
                                            </c:forEach>

                                        </div>
                                        <div class="col-md-4"> 
                                            <h:outputLabel class="navbar-text" value=" Placa: "/>
                                            <h:outputText class="navbar-text" value="#{controladorKardex.instance.vehiculo.placa}"/>

                                        </div>

                                        <div class="col-md-4"> 
                                            <h:outputLabel class="navbar-text" value=" Tipo:"/>
                                            <h:outputText class="navbar-text" value="#{controladorKardex.instance.vehiculo.tipo}"/>
                                        </div>

                                    </div>
                                    <div class="row-fluid"  >
                                        <div class="col-md-4"> 
                                            <h:outputLabel class="navbar-text" value=" Modelo:"/>
                                            <h:outputText class="navbar-text" value="#{controladorKardex.instance.vehiculo.modelo}"/>
                                        </div>
                                        <div class="col-md-4"> 

                                            <h:outputLabel class="navbar-text" value=" Color:"/>
                                            <h:outputText class="navbar-text" value="#{controladorKardex.instance.vehiculo.color}"/>

                                        </div>
                                        <div class="col-md-4"> 
                                            <h:outputLabel class="navbar-text" value=" Número de Motor:"/>
                                            <c:forEach items="#{ui.getProperties(controladorKardex.instance.vehiculo)}" var="p" >
                                                <c:if test="#{p.type == 'org.mtop.modelo.dinamico.Structure' and  p.name =='Motor'}"> 
                                                    <ui:repeat value="#{controladorKardex.instance.vehiculo.findBussinesEntityAttribute(p.name)}" var="a" varStatus="status">
                                                        <h:outputText rendered="#{a.name =='serie'}" class="navbar-text" value="#{a.value}" ></h:outputText>
                                                    </ui:repeat>
                                                </c:if>
                                            </c:forEach>

                                        </div>

                                        <div class="col-md-4"> 

                                            <h:outputLabel class="navbar-text" value=" Marca:"/>
                                            <h:outputText class="navbar-text" value="#{controladorKardex.instance.vehiculo.marca}"/>
                                        </div>
                                    </div>
                                </div>
                            </p:panel>


                        </div>

                    </p:panel >
                    <p:panel id="kar" rendered="#{controladorKardex.vista eq 'kardex' }" >
                        <div  class="panel panel-primary">

                            <div class="panel-heading" align="center">
                                BUSCAR REQUISICIONES Y SOLICITUDES DE REPARACIÓN Y MANTENIMIENTO 
                            </div>


                            <p:panel id="p1">

                                <p:tabView id="infoFM"  style="width: 99%; padding-bottom: 1.5%" >
                                    <div  class="panel panel-primary">
                                        <div  class="panel-heading"><center><h:outputLabel value="AGREGAR SOLICITUDES Y REQUISICIÓN"></h:outputLabel></center></div>  

                                        <p:tab id="ts" title="Solicitudes de Reparación y Mantenimiento" closable="false"  titleStyleClass="clearfix" >
                                            <p:panel id="sr">
                                                <div class="container-fluid" align="center">
                                                    <div class="row-fluid">


                                                        <div class="col-lg-6">
                                                            <center>
                                                                <div class="input-group">
                                                                    <center>
                                                                        <h:outputLabel value="Buscar:  " />

                                                                        <p:autoComplete styleClass="xLarge" id="acSimple" value="#{controladorKardex.palabrabs}"   
                                                                                        completeMethod="#{controladorKardex.autocompletars}"/> 



                                                                        <p:commandButton  id="buscar" icon="ui-icon-search" value="Buscar" 
                                                                                          process="@form"
                                                                                          update=":form:infoFM:listap1" action="#{controladorKardex.buscars()}" styleClass="btn btn-success" >

                                                                        </p:commandButton>


                                                                        <p:commandButton id="limpiar" icon="ui-icon-arrowrefresh-1-s" value="Limpiar"
                                                                                         process="@this"
                                                                                         update="@form" action="#{controladorKardex.limpiars()}" styleClass="btn btn-success" >

                                                                        </p:commandButton>
                                                                    </center>
                                                                </div>
                                                            </center>
                                                        </div>
                                                    </div>
                                                </div>
                                            </p:panel>
                                            <br/><br/>
                                            <p:commandButton update="@form :form:forms:gsol :form:forms:saves :form:forms:savesm"  process="@this" value="Aprobar Solicitud"  action="#{controladorKardex.irASolicitud()}"  >
                                                <f:param name="kardexId"  value="#{controladorKardex.instance.id}"></f:param>
                                                <f:param name="valorVista" value="solicitud"></f:param>
                                                <f:setPropertyActionListener value="#{null}" target="#{controladorKardex.solicitud}"/>
                                            </p:commandButton>


                                            <br/><br/>
                                            <div class="tab-content">
                                                <div class="tab-pane active" id="todas">
                                                    <div class="table-responsive">
                                                           <p:messages  id="mensajess" showDetail="true" autoUpdate="true" closable="true" />
                                                        <tbody>
                                                            <p:dataTable id="listap1" value="#{controladorKardex.listaSol}" var="s"
                                                                         paginator="true" rows="5"                         
                                                                         paginatorPosition="top"
                                                                         rowsPerPageTemplate="5,10,15,20"
                                                                         widgetVar="requisicionTable"
                                                                         emptyMessage="No se han encontrado coincidencias" >

                                                                <p:column headerText="Número de Solicitud" sortBy="#{s.numSolicitud}">
                                                                    <h:outputText value="#{s.numSolicitud}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Fecha de Solicitud" sortBy="#{s.fechaSolicitud}">
                                                                    <h:outputText value="#{controladorKardex.formato(s.fechaSolicitud)}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Registro del vehículo" sortBy="#{s.vehiculo.numRegistro}">
                                                                    <h:outputText value="#{s.vehiculo.numRegistro}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Opciones" style="width: 5%"> 

                                                                    <!--p:commandButton id="dardebaja" icon="ui-icon-trash"
                                                                                     title="Dar de baja"  
                                                                                     action="#{controladorKardex.darDeBajaS(s.id)}"  
                                                                                     update="@form">

                                                                        <f:param name="kardexId" value="#{controladorKardex.instance.id}"/>

                                                                        <f:param name="valorVista" value="kardex"/>
                                                                        <p:confirm header="Dar de Baja" message="¿Desea Realmente dar de baja a la solicitud seleccionada?" icon="ui-icon-alert" />
                                                                    </p:commandButton>
                                                                    <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
                                                                        <p:commandButton value="Si" ajax="false" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>
                                                                        <p:commandButton value="No" type="button" onclick="confirmation.hide()" styleClass="ui-confirmdialog-no" icon="ui-icon-close"  />
                                                                    </p:confirmDialog-->
                                                                </p:column>

                                                            </p:dataTable></tbody></div></div>
                                            </div>

                                        </p:tab>
                                        <p:tab title="Requisiciones" closable="false"  titleStyleClass="clearfix" >
                                            <p:panel id="rs">
                                                <div class="container-fluid" align="center">
                                                    <div class="row-fluid">


                                                        <div class="col-lg-6">
                                                            <center>
                                                                <div class="input-group">
                                                                    <center>
                                                                        <h:outputLabel value="Buscar:  " />

                                                                        <p:autoComplete styleClass="xLarge" id="acSimple2" value="#{controladorKardex.palabrabr}"   
                                                                                        completeMethod="#{controladorKardex.autocompletarr}"/> 



                                                                        <p:commandButton  id="buscar2" icon="ui-icon-search" value="Buscar" process="@form" 
                                                                                          update="@form" 
                                                                                          action="#{controladorKardex.buscarr()}" styleClass="btn btn-success" >

                                                                        </p:commandButton>


                                                                        <p:commandButton id="limpiar2" icon="ui-icon-arrowrefresh-1-s" value="Limpiar" 
                                                                                         process="@form" 
                                                                                         update="@form" action="#{controladorKardex.limpiarr()}" styleClass="btn btn-success" >

                                                                        </p:commandButton>
                                                                    </center>
                                                                </div>
                                                            </center>
                                                        </div>
                                                    </div>
                                                </div>
                                            </p:panel>
                                            <br/><br/>
                                            <p:commandButton update="@form :form:formr:pp2 :form:formr:saveg :form:formr:saveg2" process="@this" value="Aprobar Requisición"  action="#{controladorKardex.irARequisicion()}" styleClass="btn btn-success" >
                                                <f:param name="kardexId"  value="#{controladorKardex.instance.id}"></f:param>
                                                <f:param name="valorVista" value="requisicion"></f:param>
                                                <f:setPropertyActionListener value="#{null}" target="#{controladorKardex.requisicion}"/>
                                            </p:commandButton><br/><br/>

                                            <div class="tab-content">
                                                <div class="tab-pane active" id="todas">
                                                    <div class="table-responsive">
                                                        <p:messages  id="mensajer" showDetail="true" autoUpdate="true" closable="true" />

                                                        <tbody>
                                                            <p:dataTable id="listap" value="#{controladorKardex.listaReq}" var="item"

                                                                         paginator="true" rows="5"                         
                                                                         paginatorPosition="top"
                                                                         rowsPerPageTemplate="5,10,15,20"
                                                                         widgetVar="requisicionTable"   emptyMessage="No se han encontrado coincidencias">
                                                                <p:column headerText="Número de Requisición" sortBy="#{item.numRequisicion}" >
                                                                    <h:outputText value="#{item.numRequisicion}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Fecha de Requisición" sortBy="#{item.fechaRequisicion}">
                                                                    <h:outputText value="#{controladorRequisicion.formato(item.fechaRequisicion)}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Observación" sortBy="#{item.observaciones}">
                                                                    <h:outputText value="#{item.observaciones}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Registro del vehículo" sortBy="#{item.vehiculo.numRegistro}">
                                                                    <h:outputText value="#{item.vehiculo.numRegistro}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Opciones" style="width: 5%"> 

                                                                    <!--p:commandButton id="dardebaja" icon="ui-icon-trash"
                                                                                     title="Dar de baja"  
                                                                                     action="#{controladorKardex.darDeBajaR(item.id)}"  
                                                                                     update="@form :form:infoFM:listap">

                                                                        <f:param name="kardexId" value="#{controladorKardex.instance.id}"/>
                                                                        <f:param name="valorVista" value="kardex"/>
                                                                        <p:confirm header="Dar de Baja" message="¿Desea Realmente dar de baja a la solicitud seleccionada?" icon="ui-icon-alert" />
                                                                    </p:commandButton>
                                                                    <p:confirmDialog global="true" showEffect="fade" hideEffect="explode">
                                                                        <p:commandButton value="Si" ajax="false" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check"/>
                                                                        <p:commandButton value="No" type="button" onclick="confirmation.hide()" styleClass="ui-confirmdialog-no" icon="ui-icon-close"  />
                                                                    </p:confirmDialog-->
                                                                </p:column>
                                                            </p:dataTable></tbody></div></div>
                                            </div>
                                        </p:tab>
                                    </div>



                                </p:tabView>
                                <br/>

                                <mtop:input id="descripcion" name="descripcion1" type="textarea" label="Observación" 
                                            value="#{controladorKardex.instance.observaciones}"
                                            inlinehelp="Ingrese una descripción"
                                            execute ="@this save" render="descripcion"/><br></br>

                                <div class="admin-actions " align="center">
                                    <p:commandButton id="save" value="Guardar"   styleClass="btn  btn-success" action="#{controladorKardex.guardar}"
                                                     />

                                </div>

                            </p:panel>
                        </div>
                    </p:panel>










                    <div align="right">
                        <p:button id="regresar" value="Regresar" icon="ui-icon-arrowreturnthick-1-w"
                                  rendered="#{controladorKardex.vista eq 'solicitud'}" outcome="/paginas/admin/kardex/crear"
                                  styleClass="btn  btn-success"
                                  >
                            <f:param name="kardexId" value="#{controladorKardex.instance.id}"/>
                            <!--f:param name="solicitudId" value="# {solicitudListaServicios.solicitudSeleccionada.id}"></f:param-->
                            <f:param name="valorVista" value="kardex"/>



                        </p:button>
                    </div><br/>



                    <p:panel id="soli" rendered="#{controladorKardex.vista eq 'solicitud'}">

                        <div  class="panel panel-primary">

                            <div class="panel-heading" align="center">APROBAR SOLICITUDES DE REPARACIÓN Y MANTENIMIENTO</div>
                            <p:panel rendered="#{controladorKardex.vista eq 'solicitud'}" >

                                <div class="container-fluid" align="center">
                                    <div class="row-fluid"  >

                                        <h:form id="forms" rendered="#{controladorKardex.vista eq 'solicitud'}">            
                                            <p:panel>
                                                <div class="container-fluid" align="center">
                                                    <div class="row-fluid">


                                                        <div class="col-lg-6">
                                                            <center>
                                                                <div class="input-group">
                                                                    <center>
                                                                        <h:outputLabel value="Buscar:  " />

                                                                        <p:autoComplete styleClass="xLarge" id="acSimple25" value="#{controladorKardex.palabrasna}"   
                                                                                        completeMethod="#{controladorKardex.autocompletarsna}"/> 



                                                                        <p:commandButton  id="buscar25" icon="ui-icon-search" value="Buscar" 
                                                                                          process="@form"
                                                                                          update=":form:forms:listaps"  action="#{controladorKardex.buscarsna()}" 
                                                                                          styleClass="btn btn-success" >

                                                                        </p:commandButton>


                                                                        <p:commandButton id="limpiar24" icon="ui-icon-arrowrefresh-1-s"
                                                                                         value="Limpiar" process="@form" 
                                                                                         update=":form:forms:listaps :form:forms:acSimple25"  action="#{controladorKardex.limpiarsna()}"
                                                                                         styleClass="btn btn-success" >

                                                                        </p:commandButton>
                                                                    </center>
                                                                </div>
                                                            </center>
                                                        </div>
                                                    </div>
                                                </div>
                                            </p:panel>

                                            <br></br><br></br>

                                            <div class="tab-content">
                                                <div class="tab-pane active" id="todas">
                                                    <div class="table-responsive">

                                                        <p:messages  id="msg" showDetail="true" autoUpdate="true" closable="true" />
                                                        <tbody>
                                                            <p:dataTable id="listaps" value="#{controladorKardex.listasolNoAp}" var="s1"
                                                                         paginator="true" rows="5"                         
                                                                         paginatorPosition="top"
                                                                         rowsPerPageTemplate="5,10,15,20"
                                                                         widgetVar="requisicionTable"
                                                                         emptyMessage="No se han encontrado coincidencias" >

                                                                <p:column headerText="Número de Solicitud" sortBy="#{s1.numSolicitud}">
                                                                    <h:outputText value="#{s1.numSolicitud}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Fecha de Solicitud" sortBy="#{s1.fechaSolicitud}">
                                                                    <h:outputText value="#{controladorKardex.formato(s1.fechaSolicitud)}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Registro del vehículo" sortBy="#{s1.vehiculo.numRegistro}">
                                                                    <h:outputText value="#{s1.vehiculo.numRegistro}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Opciones" style="width: 5%"> 


                                                                    <p:commandLink update=":form:forms:sol :form:forms:savesm :form:forms:saves :form:forms:gsol" process="@this" value="Aprobar" title="Seleccionar">
                                                                        <f:setPropertyActionListener value="#{s1}" target="#{controladorKardex.solicitud}" />

                                                                    </p:commandLink>
                                                                </p:column>

                                                            </p:dataTable> <br/>

                                                            <p:panel id="sol"  >
                                                                <div class="panel panel-primary">
                                                                    <div class="panel-heading"  align="center">Datos de Solicitud de Reparación y Mantenimiento seleccionada</div>
                                                                    <p:panel >
                                                                        <div class="container-fluid" align="center">
                                                                            <div class="row-fluid"  >
                                                                                <div class="col-md-4"> 
                                                                                    <h:outputLabel class="navbar-text" value=" Número de Solicitud:"/>
                                                                                    <h:outputText class="navbar-text" value="#{controladorKardex.solicitud.numSolicitud}"/>

                                                                                </div>

                                                                                <div class="col-md-4"> 
                                                                                    <h:outputLabel class="navbar-text" value=" Fecha de Solicitud: "/>
                                                                                    <h:outputText class="navbar-text" 
                                                                                                  value="#{controladorKardex.formato(controladorKardex.solicitud.fechaSolicitud)}"/>

                                                                                </div>



                                                                            </div>
                                                                            <div class="row-fluid"  >
                                                                                <div class="col-md-4"> 
                                                                                    <h:outputLabel class="navbar-text" value=" Observación:"/>
                                                                                    <h:outputText class="navbar-text" value="#{controladorKardex.solicitud.observacion}"/>
                                                                                </div>


                                                                            </div>
                                                                        </div>
                                                                    </p:panel>
                                                                </div>

                                                            </p:panel>
                                                        </tbody>
                                                    </div>
                                                </div><br/>


                                                <p:panel id="gsol">

                                                    <div class="admin-actions " align="center"> 

                                                   

                                                        <p:commandButton rendered="#{controladorKardex.solicitud == null}" id="savesm" value="Guardar" 
                                                                          update=":form:forms:msg" 
                                                                          process="@form" icon="ui-icon-disk" 
                                                                          styleClass="btn  btn-success" 
                                                                          actionListener="#{controladorKardex.guardarSolicitud()}"

                                                                          >


                                                        </p:commandButton>

                                                        <p:commandButton rendered="#{controladorKardex.solicitud ne null}" id="saves"  value="Guardar" process="@form" update="@form"
                                                                         styleClass="btn  btn-success"   
                                                                         ajax="false" action="#{controladorKardex.guardarSolicitud()}" >
                                                            <f:param name="kardexId" value="#{controladorKardex.instance.id}"/>
                                                            <f:param name="valorVista" value="kardex"/>
                                                      


                                                        </p:commandButton>


                                                    </div>
                                                </p:panel>


                                                <div align="right">
                                                   

                                                    <p:commandButton id="sa" value="Guardar1" 
                                                                   
                                                                     process="@form" icon="ui-icon-disk" 
                                                                     styleClass="btn  btn-success" 
                                                                     actionListener="#{controladorKardex.guardarSolicitud()}"

                                                                     >


                                                    </p:commandButton>
                                                </div><br/>



                                            </div>


                                        </h:form>
                                    </div>
                                </div>
                            </p:panel>

                        </div>


                    </p:panel>

                    <div align="right">
                        <p:button id="regresar1" icon="ui-icon-arrowreturnthick-1-w" value="Regresar" rendered="#{controladorKardex.vista eq 'requisicion'}"
                                  outcome="/paginas/admin/kardex/crear" styleClass="btn  btn-success"
                                  >
                            <f:param name="kardexId" value="#{controladorKardex.instance.id}"/>
                            <f:param name="valorVista" value="kardex"/>
                        </p:button>
                    </div><br/>
                    <p:panel rendered="#{controladorKardex.vista eq 'requisicion'}">

                        <div  class="panel panel-primary">

                            <div class="panel-heading" align="center">APROBAR REQUISICIONES</div>
                            <p:panel rendered="#{controladorKardex.vista eq 'requisicion'}">
                                <div class="container-fluid" align="center">
                                    <div class="row-fluid"  >

                                        <h:form id="formr" rendered="#{controladorKardex.vista eq 'requisicion'}">            

                                            <!--Opción de mensaje, cuando se realiza una acción-->
                                            <p:panel>
                                                <div class="container-fluid" align="center">
                                                    <div class="row-fluid">


                                                        <div class="col-lg-6">
                                                            <center>
                                                                <div class="input-group">
                                                                    <center>
                                                                        <h:outputLabel value="Buscar:  " />

                                                                        <p:autoComplete styleClass="xLarge" id="acSimple24" value="#{controladorKardex.palabrarna}"   
                                                                                        completeMethod="#{controladorKardex.autocompletarrna}"/> 



                                                                        <p:commandButton  id="buscar2" icon="ui-icon-search" value="Buscar" 
                                                                                          process="@form"
                                                                                          update=":form:formr:listapr"  action="#{controladorKardex.buscarrna()}" 
                                                                                          styleClass="btn btn-success" >

                                                                        </p:commandButton>


                                                                        <p:commandButton id="limpiar2" icon="ui-icon-arrowrefresh-1-s"
                                                                                         value="Limpiar" process="@form" 
                                                                                         update=":form:formr:listapr :form:formr:acSimple24"  action="#{controladorKardex.limpiarna()}"
                                                                                         styleClass="btn btn-success" >

                                                                        </p:commandButton>
                                                                    </center>
                                                                </div>
                                                            </center>
                                                        </div>
                                                    </div>
                                                </div>
                                            </p:panel>
                                            <br></br><br></br>

                                            <div class="tab-content">
                                                <div class="tab-pane active" id="todas">
                                                    <div class="table-responsive">

                                                        <p:messages  id="mensajes" showDetail="true" autoUpdate="true" closable="true" />
                                                        <tbody>
                                                            <p:dataTable id="listapr" value="#{controladorKardex.listareqNoAp}" var="itemr"

                                                                         paginator="true" rows="5"                         
                                                                         paginatorPosition="top"
                                                                         rowsPerPageTemplate="5,10,15,20"
                                                                         widgetVar="requisicionTable"   emptyMessage="No se han encontrado coincidencias">
                                                                <p:column headerText="Número de Requisición" sortBy="#{itemr.numRequisicion}" >
                                                                    <h:outputText value="#{itemr.numRequisicion}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Fecha de Requisición" sortBy="#{itemr.fechaRequisicion}">
                                                                    <h:outputText value="#{controladorRequisicion.formato(itemr.fechaRequisicion)}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Observación" sortBy="#{itemr.observaciones}">
                                                                    <h:outputText value="#{itemr.observaciones}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Registro del vehículo" sortBy="#{itemr.vehiculo.numRegistro}">
                                                                    <h:outputText value="#{itemr.vehiculo.numRegistro}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Opciones" style="width: 5%"> 
                                                                    <p:commandLink update=":form:formr:req :form:formr:pp2 :form:formr:saveg2 :form:formr:saveg" process="@this" value="Aprobar" title="Seleccionar">
                                                                        <f:setPropertyActionListener value="#{itemr}" target="#{controladorKardex.requisicion}" />

                                                                    </p:commandLink>

                                                                </p:column>
                                                            </p:dataTable> <br/>
                                                            <p:panel id="req"  >
                                                                <div class="panel panel-primary">
                                                                    <div class="panel-heading"  align="center">Datos de Requisición seleccionada</div>
                                                                    <p:panel >
                                                                        <div class="container-fluid" align="center">
                                                                            <div class="row-fluid"  >
                                                                                <div class="col-md-4"> 
                                                                                    <h:outputLabel class="navbar-text" value=" Número de Requisición:"/>
                                                                                    <h:outputText class="navbar-text" value="#{controladorKardex.requisicion.numRequisicion}"/>

                                                                                </div>

                                                                                <div class="col-md-4"> 
                                                                                    <h:outputLabel class="navbar-text" value=" Fecha de Requisición: "/>
                                                                                    <h:outputText class="navbar-text" 
                                                                                                  value="#{controladorKardex.formato(controladorKardex.requisicion.fechaRequisicion)}"/>

                                                                                </div>



                                                                            </div>
                                                                            <div class="row-fluid"  >
                                                                                <div class="col-md-4"> 
                                                                                    <h:outputLabel class="navbar-text" value=" Observación:"/>
                                                                                    <h:outputText class="navbar-text" value="#{controladorKardex.requisicion.observaciones}"/>
                                                                                </div>


                                                                            </div>
                                                                        </div>
                                                                    </p:panel>
                                                                </div>

                                                            </p:panel>
                                                        </tbody>
                                                    </div>
                                                </div>
                                                <p:panel id="pp2">
                                                    <div class="admin-actions " align="center"> 

                                                        <p:commandButton rendered="#{controladorKardex.requisicion == null}" id="saveg" value="Guardar" 
                                                                         update=":form:formr:mensajes" 
                                                                         process="@form" icon="ui-icon-disk" 
                                                                         styleClass="btn  btn-success" 
                                                                         actionListener="#{controladorKardex.guardarRequisicion()}"

                                                                         >


                                                        </p:commandButton>

                                                        <p:commandButton rendered="#{controladorKardex.requisicion ne null}" id="saveg2"  value="Guardar" process="@form" update="@form"
                                                                         styleClass="btn  btn-success" icon="ui-icon-disk" 
                                                                         ajax="false" action="#{controladorKardex.guardarRequisicion()}" >
                                                            <f:param name="kardexId" value="#{controladorKardex.instance.id}"/>
                                                            <f:param name="valorVista" value="kardex"/>


                                                        </p:commandButton>


                                                    </div>
                                                </p:panel>
                                            </div>
                                        </h:form>
                                    </div>
                                </div>
                            </p:panel>

                        </div>


                    </p:panel>
                </div>
            </div>
        </h:form>

    </ui:define>
</ui:composition>
