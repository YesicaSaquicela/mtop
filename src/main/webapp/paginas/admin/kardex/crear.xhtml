<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"                
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                xmlns:c="http://java.sun.com/jsp/jstl/core"
                xmlns:s="http://jboss.org/seam/faces"
                xmlns:ocp="http://java.sun.com/jsf/composite/ocpcommon"
                xmlns:mtop="http://mtop.org/jsf/facelets"
                template="/WEB-INF/templates/plantilla.xhtml">

    <ui:param name="titulo" value="Kardex"/>
    <f:metadata>
        <f:viewParam id="stadossss" name="estado" value="#{controladorKardex.estado}"/>
        <f:viewParam id="kardexx" name="kardexId" value="#{controladorKardex.kardexId}"/>
        <f:viewParam id="vistaaa" name="valorVista" value="#{controladorKardex.vista}"/>
        <f:viewParam id="requisicioniddd" name="requisicionId" value="#{controladorKardex.requisicionId}"/>
        <f:viewParam id="solicituddd" name="solicitudId" value="#{controladorKardex.solicitudId}"/>

    </f:metadata>
    <ui:define name="header">


    </ui:define>
    <ui:define name="content">

        <h:form id="form">
            <div role="main">
                <div class="container-content" style="margin: 1em 5em 6em 5em; " align="left">
                    <div align="right">    

                        <p:button rendered="#{controladorKardex.vista eq 'kardex'}"
                                  icon="ui-icon-arrowreturnthick-1-w" value="Regresar" 
                                  outcome="/paginas/admin/kardex/lista"

                                  styleClass="btn  btn-success"/>
                    </div><br/>
                    <p:panel id="infovehiculo" rendered="#{controladorKardex.vista eq 'kardex'}">

                        <div class="panel panel-primary">
                            <div class="panel-heading" align="center">ESPECIFICACIÓNES TÉCNICAS DEL VEHÍCULO</div>
                            <p:panel >
                                <div class="container-fluid" align="center">
                                    <div class="row-fluid"  >
                                        <div class="col-md-4"> 
                                            <h:outputLabel class="navbar-text" value=" Registro:"/>
                                            <h:outputText class="navbar-text" value="#{controladorKardex.instance.vehiculo.numRegistro}"/>

                                        </div>
                                        <div class="col-md-4"> 
                                            <h:outputLabel class="navbar-text" value=" Número de chasís: "/>

                                            <c:forEach items="#{ui.getProperties(controladorKardex.instance.vehiculo)}" var="p" >
                                                <c:if test="#{p.type == 'org.mtop.modelo.dinamico.Structure' and p.name =='Chasis'}">
                                                    <ui:repeat value="#{controladorKardex.instance.vehiculo.findBussinesEntityAttribute(p.name)}" var="a" varStatus="status"> 
                                                        <h:outputText rendered="#{a.name =='serieChasis'}" class="navbar-text" value="#{a.value}" ></h:outputText>
                                                    </ui:repeat>
                                                </c:if>
                                            </c:forEach>

                                        </div>
                                        <div class="col-md-4"> 
                                            <h:outputLabel class="navbar-text" value=" Placa: "/>
                                            <h:outputText class="navbar-text" value="#{controladorKardex.instance.vehiculo.placa}"/>

                                        </div>

                                        <div class="col-md-4"> 
                                            <h:outputLabel class="navbar-text" value=" Tipo:"/>
                                            <h:outputText class="navbar-text" value="#{controladorKardex.instance.vehiculo.tipo}"/>
                                        </div>

                                    </div>
                                    <div class="row-fluid"  >
                                        <div class="col-md-4"> 
                                            <h:outputLabel class="navbar-text" value=" Modelo:"/>
                                            <h:outputText class="navbar-text" value="#{controladorKardex.instance.vehiculo.modelo}"/>
                                        </div>
                                        <div class="col-md-4"> 

                                            <h:outputLabel class="navbar-text" value=" Color:"/>
                                            <h:outputText class="navbar-text" value="#{controladorKardex.instance.vehiculo.color}"/>

                                        </div>
                                        <div class="col-md-4"> 
                                            <h:outputLabel class="navbar-text" value=" Número de motor:"/>
                                            <c:forEach items="#{ui.getProperties(controladorKardex.instance.vehiculo)}" var="p" >
                                                <c:if test="#{p.type == 'org.mtop.modelo.dinamico.Structure' and  p.name =='Motor'}"> 
                                                    <ui:repeat value="#{controladorKardex.instance.vehiculo.findBussinesEntityAttribute(p.name)}" var="a" varStatus="status">
                                                        <h:outputText rendered="#{a.name =='serieMotor'}" class="navbar-text" value="#{a.value}" ></h:outputText>
                                                    </ui:repeat>
                                                </c:if>
                                            </c:forEach>

                                        </div>

                                        <div class="col-md-4"> 

                                            <h:outputLabel class="navbar-text" value=" Marca:"/>
                                            <h:outputText class="navbar-text" value="#{controladorKardex.instance.vehiculo.marca}"/>
                                        </div>
                                    </div>
                                </div>
                            </p:panel>


                        </div>

                    </p:panel >
                    <p:panel id="kar" rendered="#{controladorKardex.vista eq 'kardex'}">
                        <div  class="panel panel-primary">

                            <div class="panel-heading" align="center">
                                BUSCAR REQUISICIONES Y SOLICITUDES DE REPARACIÓN Y MANTENIMIENTO 
                            </div>


                            <p:panel id="p1">

                                <p:tabView id="infoFM"  style="width: 99%; padding-bottom: 1.5%" >
                                    <div  class="panel panel-primary">
                                        <div  class="panel-heading"><center><h:outputLabel value="AGREGAR SOLICITUDES Y REQUISICIÓN"></h:outputLabel></center></div>  

                                        <p:tab id="ts" title="Solicitudes de reparación y mantenimiento" closable="false"  titleStyleClass="clearfix" >

                                            <div class="panel panel-info">
                                                <div class="panel-heading">
                                                    <center>
                                                        <h:outputLabel value="Buscar:  " />

                                                        <p:autoComplete styleClass="xLarge" id="acSimple" value="#{controladorKardex.palabrabs}"   
                                                                        completeMethod="#{controladorKardex.autocompletars}"/> #{' '}



                                                        <p:commandLink  id="buscar" type="button" value="Buscar" 
                                                                        process="@form"
                                                                        update=":form:infoFM:listap1" action="#{controladorKardex.buscars()}" styleClass="btn btn-success" >

                                                        </p:commandLink>

                                                        #{' '}#{' '}
                                                        <p:commandLink id="limpiar" type="button" value="Limpiar"
                                                                       process="@this"
                                                                       update="@form" action="#{controladorKardex.limpiars()}" styleClass="btn btn-success" >

                                                        </p:commandLink>
                                                    </center>

                                                </div>
                                            </div>

                                            <br/>

                                            <p:commandLink type="button" styleClass="btn  btn-success" update="@form :form:forms:gsol :form:forms:saves :form:forms:savesm"  process="@this" value="Aprobar Solicitud"  action="#{controladorKardex.irASolicitud()}"  >
                                                <f:param name="kardexId"  value="#{controladorKardex.instance.id}"></f:param>
                                                <f:param name="valorVista" value="solicitud"></f:param>
                                                <f:setPropertyActionListener value="#{null}" target="#{controladorKardex.solicitud}"/>
                                            </p:commandLink>
                                            <br/><br/>
                                            <div class="tab-content">
                                                <div class="tab-pane active" id="todas">
                                                    <div class="table-responsive">
                                                        <p:messages  id="mensajess" showDetail="true" autoUpdate="true" closable="true" />
                                                        <tbody>
                                                            <p:dataTable id="listap1" value="#{controladorKardex.listaSol}" var="s"
                                                                         paginator="true" rows="5"                         
                                                                         paginatorPosition="top"
                                                                         rowsPerPageTemplate="5,10,15,20"
                                                                         widgetVar="requisicionTable"
                                                                         emptyMessage="No se han encontrado coincidencias" >

                                                                <f:facet name="header">
                                                                    Lista de solicitudes aprobadas
                                                                </f:facet>
                                                                <p:column headerText="Número de solicitud" sortBy="#{s.numSolicitud}">
                                                                    <h:outputText value="#{s.numSolicitud}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Fecha de solicitud" sortBy="#{s.fechaSolicitud}">
                                                                    <h:outputText value="#{controladorKardex.formato(s.fechaSolicitud)}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Registro del vehículo" sortBy="#{s.vehiculo.numRegistro}">
                                                                    <h:outputText value="#{s.vehiculo.numRegistro}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Dar de Baja" style="width: 5%"> 
                                                                    <p:commandButton icon="ui-icon-trash" title="Dar de baja"  
                                                                                     actionListener="#{controladorKardex.fijarSoli(s)}" 
                                                                                     oncomplete="dlg2.show();" update=":dia2" process="@this"
                                                                                     style="margin-top:10px;" >                          
                                                                    </p:commandButton> 

                                                                </p:column>

                                                            </p:dataTable>




                                                        </tbody></div></div>
                                            </div>

                                        </p:tab>
                                        <p:tab title="Requisiciones" closable="false"  titleStyleClass="clearfix" >

                                            <div class="panel panel-info">
                                                <div class="panel-heading">



                                                    <center>
                                                        <h:outputLabel value="Buscar:  " />

                                                        <p:autoComplete styleClass="xLarge" id="acSimple2" value="#{controladorKardex.palabrabr}"   
                                                                        completeMethod="#{controladorKardex.autocompletarr}"/> #{' '}



                                                        <p:commandLink  id="buscar2" type="button" value="Buscar" process="@form" 

                                                                        update=":form:infoFM:listap" 

                                                                        action="#{controladorKardex.buscarr()}" styleClass="btn btn-success" >

                                                        </p:commandLink>
                                                        #{' '} #{' '}

                                                        <p:commandLink id="limpiar2" type="button" value="Limpiar" 
                                                                       process="@form" 
                                                                       update="@form" action="#{controladorKardex.limpiarr()}" styleClass="btn btn-success" >

                                                        </p:commandLink>
                                                    </center>

                                                </div>
                                            </div>

                                            <br/>
                                            <p:commandLink type="button" update="@form :form:formr:pp2 :form:formr:saveg :form:formr:saveg2" process="@this" value="Aprobar requisición"  action="#{controladorKardex.irARequisicion()}" styleClass="btn btn-success" >
                                                <f:param name="kardexId"  value="#{controladorKardex.instance.id}"></f:param>
                                                <f:param name="valorVista" value="requisicion"></f:param>
                                                <f:setPropertyActionListener value="#{null}" target="#{controladorKardex.requisicion}"/>
                                            </p:commandLink>
                                            <br/><br/>
                                            <div class="tab-content">
                                                <div class="tab-pane active" id="todas">
                                                    <div class="table-responsive">
                                                        <p:messages  id="mensajer" showDetail="true" autoUpdate="true" closable="true" />

                                                        <tbody>

                                                            <p:dataTable id="listap" value="#{controladorKardex.listaReq}" var="item"

                                                                         paginator="true" rows="5"                         
                                                                         paginatorPosition="top"
                                                                         rowsPerPageTemplate="5,10,15,20"
                                                                         widgetVar="requisicionTable"   emptyMessage="No se han encontrado coincidencias">
                                                                <f:facet name="header">
                                                                    Lista de requisiciones aprobadas
                                                                </f:facet>
                                                                <p:column headerText="Número de requisición" sortBy="#{item.numRequisicion}" >
                                                                    <h:outputText value="#{item.numRequisicion}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Fecha de requisición" sortBy="#{item.fechaRequisicion}">
                                                                    <h:outputText value="#{controladorRequisicion.formato(item.fechaRequisicion)}"></h:outputText>
                                                                </p:column>
                                                                
                                                                <p:column headerText="Registro del vehículo" sortBy="#{item.vehiculo.numRegistro}">
                                                                    <h:outputText value="#{item.vehiculo.numRegistro}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Dar de baja" style="width: 5%"> 

                                                                    <p:commandButton icon="ui-icon-trash" title="Dar de baja"   
                                                                                     actionListener="#{controladorKardex.fijarRequi(item)}" 
                                                                                     oncomplete="dlg1.show();" update=":dia" process="@this"
                                                                                     style="margin-top:10px;" >                          
                                                                    </p:commandButton> 
                                                                  



                                                                </p:column>
                                                            </p:dataTable>


                                                        </tbody></div></div>
                                            </div>
                                        </p:tab>
                                    </div>



                                </p:tabView>
                    
                                <br></br>

                             <br></br><br></br>


                            </p:panel>
                            
                             
                            
                        </div>
                    </p:panel>
                     <p:panel id="panel7"  rendered="#{ui.tieneValores(controladorKardex.instance) and controladorKardex.vista eq 'kardex'}">    

                        <div class="panel panel-primary">
                            <div class="panel-heading" align="center">
                                DATOS ADICIONALES
                            </div>

                            <p:tabView  id="infoFM1" style="width: 99%; padding-bottom: 1.5%">

                                <c:forEach items="#{ui.getProperties(controladorKardex.instance)}" var="p" >
                                    <div  class="panel panel-primary">
                                        <div  class="panel-heading"><center><h:outputLabel value="#{p.label}"></h:outputLabel></center></div>  

                                        <p:tab title="#{p.label}"  closable="false"  titleStyleClass="clearfix" 
                                               rendered="#{p.type == 'org.mtop.modelo.dinamico.Structure' }" >
                                            <c:choose>                        
                                                <c:when test="#{p.type == 'org.mtop.modelo.dinamico.Structure'}"> 

                                              


                                                        <ui:repeat value="#{controladorKardex.instance.findBussinesEntityAttribute(p.name)}" var="a" varStatus="status">                                               


                                                            <h:panelGroup id="panel1" layout="block" class="clearfix">

                                                                <label for="#{a.name}" class="#{(not empty a.property.required and a.property.required) ? 'required' : ''}">
                                                                    #{a.property.label}#{(not empty a.property.required and a.property.required) ? '*&#160;' : ''}</label>
                                                                <div class="input">

                                                                    <p:inputText id="str"  value="#{a.value}" styleClass="form-control" 
                                                                                 required="#{a.property.required}" label="#{a.property.label}" 
                                                                                 rendered="#{a.property.type eq 'java.lang.String'}">

                                                                        <f:ajax execute="str" render="panel1"/>
                                                                    </p:inputText>
                                                                    
                                                                    <pe:inputNumber id="str1" value="#{a.value}"  style="width: 100%"
                                                                                    required="#{a.property.required}" label="#{a.property.label}" 
                                                                                    decimalPlaces="2"  rendered="#{a.property.type eq 'java.lang.Double' or a.property.type eq 'java.lang.Long' or type eq 'java.lang.Float'}">  
                                                                       <f:ajax execute="str1" render="panel1"/>
                                                                    </pe:inputNumber>  

                                                                    <p:calendar id="str2" value="#{a.value}" navigator="true" label="#{a.property.label}"  style="width: 100%"
                                                                                rendered="#{a.property.type eq 'java.util.Date'}" required="#{a.property.required}"  >
                                                                        <f:ajax execute="str2" render="panel1"/>
                                                                    </p:calendar>

                                                                    <p:selectOneMenu id="str3" value="#{a.value}" effect="fade"  converter="#{omnifaces.SelectItemsConverter}" required="#{a.property.required}" 
                                                                                     label="#{a.property.label}" style="width: 100%"
                                                                                     rendered="#{a.property.type eq 'java.lang.String[]' or a.property.type eq 'org.mtop.modelo.EstadoParteMecanica'}">  
                                                                        <f:selectItems value="#{ui.getValuesAsSelectItem(a.property.values)}" var="v" itemLabel="#{v.label}" itemValue="#{v}"/>  
                                                                        <f:ajax execute="str3" event="change" render="panel1"/>
                                                                    </p:selectOneMenu>
                                                                    <p:inputTextarea id="str4" value="#{a.value}" styleClass="form-control" required="#{a.property.required}" label="#{a.property.label}" style="width: 100%; height: 100px;" 
                                                                                     rendered="#{a.property.type eq 'java.lang.MultiLineString'}">
                                                                       <f:ajax execute="str4" render="panel1"/>
                                                                    </p:inputTextarea>  

                                                                    <pe:inputNumber id="str5" value="#{a.value}"  style="width: 100%"
                                                                                    required="#{a.property.required}" label="#{a.property.label}" 
                                                                                    decimalPlaces="0"    rendered="#{a.property.type eq 'java.lang.Integer'}">
                                                                        <f:ajax execute="str5" render="panel1"/>
                                                                    </pe:inputNumber>  

                                                                    <p:selectOneButton value="#{a.value}" style="width: 100%" rendered="#{a.property.type eq 'java.lang.Boolean'}" >
                                                                        <f:selectItem itemLabel="true" itemValue="true" />
                                                                        <f:selectItem itemLabel="false" itemValue="false" />
                                                                    </p:selectOneButton>
                                                                    <br/>
                                                                   
                                                                    <h:graphicImage value="#{resource['visto.png']}" rendered="#{a.value ne '' and controladorKardex.instance.persistent}"
                                                                                    styleClass="validation-status" />
                                                                    <h:graphicImage value="#{resource['visto.png']}" rendered="#{a.value ne null and controladorKardex.instance.persistent eq false}"
                                                                                    styleClass="validation-status" />
                                                              
                                                                    <span class="help-inline text-muted">#{a.property.helpInline} 
                                                                        <ocp:message forId="str" />
                                                                        <ocp:message forId="str1" />
                                                                        <ocp:message forId="str2" />
                                                                        <ocp:message forId="str3" />
                                                                        <ocp:message forId="str4" />
                                                                        <ocp:message forId="str5" />
                                                                    </span><br/><br/>
                                                                </div>
                                                                
                                                            </h:panelGroup>  


                                                        </ui:repeat>
                                                    

                                                </c:when>
                                            </c:choose>
                                        </p:tab>
                                    </div>
                                </c:forEach>



                                <p:tab title="Otros" rendered="#{controladorKardex.instance.findBussinesEntityAttribute('org.mtop.modelo.Kardex').size() ne 0 }" closable="false"  titleStyleClass="clearfix"  >

                                    <ui:repeat value="#{controladorKardex.instance.findBussinesEntityAttribute('org.mtop.modelo.Kardex')}" var="a" varStatus="status"> 
                                         <h:panelGroup id="otro" layout="block" class="clearfix">
                                            <label for="#{a.name}" class="#{(not empty a.property.required and a.property.required) ? 'required' : ''}">
                                                #{a.property.label}#{(not empty a.property.required and a.property.required) ? '*&#160;' : ''}</label>
                                            <div class="input">

                                                <p:inputText id="str"  value="#{a.value}" styleClass="form-control" 
                                                             required="#{a.property.required}" label="#{a.property.label}" 
                                                             rendered="#{a.property.type eq 'java.lang.String'}">

                                                    <f:ajax execute="str" render="otro"/>
                                                </p:inputText>

                                                <pe:inputNumber id="str1" value="#{a.value}"  style="width: 100%"
                                                                required="#{a.property.required}" label="#{a.property.label}" 
                                                                decimalPlaces="2"  rendered="#{a.property.type eq 'java.lang.Double' or a.property.type eq 'java.lang.Long' or type eq 'java.lang.Float'}">  
                                                   <f:ajax execute="str1" render="otro"/>
                                                </pe:inputNumber>  

                                                <p:calendar id="str2" value="#{a.value}" navigator="true" label="#{a.property.label}"  style="width: 100%"
                                                            rendered="#{a.property.type eq 'java.util.Date'}" required="#{a.property.required}"  >
                                                    <f:ajax execute="str2" render="otro"/>
                                                </p:calendar>

                                                <p:selectOneMenu id="str3" value="#{a.value}" effect="fade"  converter="#{omnifaces.SelectItemsConverter}" required="#{a.property.required}" 
                                                                 label="#{a.property.label}" style="width: 100%"
                                                                 rendered="#{a.property.type eq 'java.lang.String[]' or a.property.type eq 'org.mtop.modelo.EstadoParteMecanica'}">  
                                                    <f:selectItems value="#{ui.getValuesAsSelectItem(a.property.values)}" var="v" itemLabel="#{v.label}" itemValue="#{v}"/>  
                                                    <f:ajax execute="str3" event="change" render="otro"/>
                                                </p:selectOneMenu>
                                                <p:inputTextarea id="str4" value="#{a.value}" style="width: 100%; height: 100px;"  required="#{a.property.required}" label="#{a.property.label}" 
                                                                 rendered="#{a.property.type eq 'java.lang.MultiLineString'}">
                                                   <f:ajax execute="str4" render="otro"/>
                                                </p:inputTextarea>  

                                                <pe:inputNumber id="str5" value="#{a.value}"  style="width: 100%"
                                                                required="#{a.property.required}" label="#{a.property.label}" 
                                                                decimalPlaces="0"    rendered="#{a.property.type eq 'java.lang.Integer'}">
                                                    <f:ajax execute="str5" render="otro"/>
                                                </pe:inputNumber>  

                                                <p:selectOneButton value="#{a.value}" style="width: 100%" rendered="#{a.property.type eq 'java.lang.Boolean'}" >
                                                    <f:selectItem itemLabel="true" itemValue="true" />
                                                    <f:selectItem itemLabel="false" itemValue="false" />
                                                </p:selectOneButton>
                                                <br/>

                                                <h:graphicImage value="#{resource['visto.png']}" rendered="#{a.value ne '' and controladorKardex.instance.persistent}"
                                                                styleClass="validation-status" />
                                                <h:graphicImage value="#{resource['visto.png']}" rendered="#{a.value ne null and controladorKardex.instance.persistent eq false}"
                                                                styleClass="validation-status" />

                                                <span class="help-inline text-muted">#{a.property.helpInline} 
                                                    <ocp:message forId="str" />
                                                    <ocp:message forId="str1" />
                                                    <ocp:message forId="str2" />
                                                    <ocp:message forId="str3" />
                                                    <ocp:message forId="str4" />
                                                    <ocp:message forId="str5" />
                                                </span><br/><br/>
                                            </div>
                                        </h:panelGroup>

                                    </ui:repeat>

                                </p:tab>
                               

                            </p:tabView>

                        </div>

                    </p:panel> <br></br><br></br> 



                    <div align="right">
                        <p:button id="regresar" value="Regresar" icon="ui-icon-arrowreturnthick-1-w"
                                  rendered="#{controladorKardex.vista eq 'solicitud'}" outcome="/paginas/admin/kardex/crear"
                                  styleClass="btn  btn-success"
                                  >
                            <f:param name="kardexId" value="#{controladorKardex.instance.id}"/>
                            <!--f:param name="solicitudId" value="# {solicitudListaServicios.solicitudSeleccionada.id}"></f:param-->
                            <f:param name="valorVista" value="kardex"/>



                        </p:button>
                    </div><br/>



                    <p:panel id="soli" rendered="#{controladorKardex.vista eq 'solicitud'}">

                        <div  class="panel panel-primary">

                            <div class="panel-heading" align="center">APROBAR SOLICITUDES DE REPARACIÓN Y MANTENIMIENTO</div>
                            <p:panel rendered="#{controladorKardex.vista eq 'solicitud'}" >

                                <div class="container-fluid" align="center">
                                    <div class="row-fluid"  >

                                        <h:form id="forms" rendered="#{controladorKardex.vista eq 'solicitud'}">            

                                            <div class="panel panel-info">
                                                <div class="panel-heading">



                                                    <center>
                                                        <h:outputLabel value="Buscar:  " />

                                                        <p:autoComplete styleClass="xLarge" id="acSimple25" value="#{controladorKardex.palabrasna}"   
                                                                        completeMethod="#{controladorKardex.autocompletarsna}"/> #{' '}



                                                        <p:commandLink  id="buscar25" type="button" value="Buscar" 
                                                                        process="@form"
                                                                        update=":form:forms:listaps"  action="#{controladorKardex.buscarsna()}" 
                                                                        styleClass="btn btn-success" >

                                                        </p:commandLink>
                                                        #{' '}#{' '}

                                                        <p:commandLink id="limpiar24" type="button"
                                                                       value="Limpiar" process="@form" 
                                                                       update=":form:forms:listaps :form:forms:acSimple25"  action="#{controladorKardex.limpiarsna()}"
                                                                       styleClass="btn btn-success" >

                                                        </p:commandLink>
                                                    </center>

                                                </div>
                                            </div>


                                            <br></br>

                                            <div class="tab-content">
                                                <div class="tab-pane active" id="todas">
                                                    <div class="table-responsive">

                                                        <p:messages  id="msg" showDetail="true" autoUpdate="true" closable="true" />
                                                        <tbody>

                                                            <p:dataTable id="listaps" value="#{controladorKardex.listasolNoAp}" var="s1"
                                                                         paginator="true" rows="5"                         
                                                                         paginatorPosition="top"
                                                                         rowsPerPageTemplate="5,10,15,20"
                                                                         widgetVar="requisicionTable"
                                                                         emptyMessage="No se han encontrado coincidencias" >
                                                                <f:facet name="header">
                                                                    Lista de solicitudes no aprobadas
                                                                </f:facet>

                                                                <p:column headerText="Número de solicitud" sortBy="#{s1.numSolicitud}">
                                                                    <h:outputText value="#{s1.numSolicitud}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Fecha de solicitud" sortBy="#{s1.fechaSolicitud}">
                                                                    <h:outputText value="#{controladorKardex.formato(s1.fechaSolicitud)}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Registro del vehículo" sortBy="#{s1.vehiculo.numRegistro}">
                                                                    <h:outputText value="#{s1.vehiculo.numRegistro}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Aprobar" style="width: 5%"> 


                                                                    <p:commandButton update=":form:forms:sol :form:forms:savesm :form:forms:saves :form:forms:gsol" process="@this" title="Aprobar" icon="ui-icon-check">
                                                                        <f:setPropertyActionListener value="#{s1}" target="#{controladorKardex.solicitud}" />

                                                                    </p:commandButton>
                                                                </p:column>

                                                            </p:dataTable> <br/>

                                                            <p:panel id="sol" >
                                                                <div class="panel panel-primary">
                                                                    <div class="panel-heading"  align="center">Datos de solicitud de reparación y mantenimiento seleccionada</div>
                                                                    <p:panel >
                                                                        <div class="container-fluid" align="center">
                                                                            <div class="row-fluid"  >
                                                                                <div class="col-md-4"> 
                                                                                    <h:outputLabel class="navbar-text" value=" Número de solicitud:"/>
                                                                                    <h:outputText class="navbar-text" value="#{controladorKardex.solicitud.numSolicitud}"/>

                                                                                </div>

                                                                                <div class="col-md-4"> 
                                                                                    <h:outputLabel class="navbar-text" value=" Fecha de solicitud: "/>
                                                                                    <h:outputText class="navbar-text" 
                                                                                                  value="#{controladorKardex.formato(controladorKardex.solicitud.fechaSolicitud)}"/>

                                                                                </div>



                                                                            </div>
                                                                            <div class="row-fluid"  >
                                                                                <div class="col-md-4"> 
                                                                                    <h:outputLabel class="navbar-text" value=" Observación:"/>
                                                                                    <h:outputText class="navbar-text" value="#{controladorKardex.solicitud.observacion}"/>
                                                                                </div>


                                                                            </div>
                                                                        </div>
                                                                    </p:panel>
                                                                </div>

                                                            </p:panel>
                                                        </tbody>
                                                    </div>
                                                </div><br/>


                                                <p:panel id="gsol">

                                                    <div class="admin-actions " align="center"> 



                                                        <p:commandButton rendered="#{controladorKardex.solicitud == null}" id="savesm" value="Guardar" 
                                                                         update=":form:forms:msg" 
                                                                         process="@form" icon="ui-icon-disk" 
                                                                         styleClass="btn  btn-success" 
                                                                         actionListener="#{controladorKardex.guardarSolicitud()}"

                                                                         >


                                                        </p:commandButton>
                                                        <p:button rendered="#{controladorKardex.solicitud ne null}" id="saves"  value="Guardar" 
                                                                  styleClass="btn  btn-success" icon="ui-icon-disk" 
                                                                  outcome="/paginas/admin/kardex/crear" >
                                                            <f:param name="estado" value="true"/>
                                                            <f:param name="kardexId" value="#{controladorKardex.instance.id}"/>
                                                            <f:param name="solicitudId" value="#{controladorKardex.solicitud.id}"/>
                                                            <f:param name="valorVista" value="kardex"/>



                                                        </p:button>




                                                    </div>
                                                </p:panel>





                                            </div>


                                        </h:form>
                                    </div>
                                </div>
                            </p:panel>

                        </div>


                    </p:panel>

                    <div align="right">
                        <p:button id="regresar1" icon="ui-icon-arrowreturnthick-1-w" value="Regresar" rendered="#{controladorKardex.vista eq 'requisicion'}"
                                  outcome="/paginas/admin/kardex/crear" styleClass="btn  btn-success"
                                  >
                            <f:param name="kardexId" value="#{controladorKardex.instance.id}"/>
                            <f:param name="valorVista" value="kardex"/>
                        </p:button>
                    </div><br/>
                    <p:panel rendered="#{controladorKardex.vista eq 'requisicion'}">

                        <div  class="panel panel-primary">

                            <div class="panel-heading" align="center">APROBAR REQUISICIONES</div>
                            <p:panel rendered="#{controladorKardex.vista eq 'requisicion'}">
                                <div class="container-fluid" align="center">
                                    <div class="row-fluid"  >

                                        <h:form id="formr" rendered="#{controladorKardex.vista eq 'requisicion'}">            

                                            <!--Opción de mensaje, cuando se realiza una acción-->

                                            <div class="panel panel-info">
                                                <div class="panel-heading">


                                                    <center>
                                                        <h:outputLabel value="Buscar:  " />

                                                        <p:autoComplete styleClass="xLarge" id="acSimple24" value="#{controladorKardex.palabrarna}"   
                                                                        completeMethod="#{controladorKardex.autocompletarrna}"/> #{' '}



                                                        <p:commandLink  id="buscar2" type="button" value="Buscar" 
                                                                        process="@form"
                                                                        update=":form:formr:listapr"  action="#{controladorKardex.buscarrna()}" 
                                                                        styleClass="btn btn-success" >

                                                        </p:commandLink>

                                                        #{' '}#{' '}
                                                        <p:commandLink id="limpiar2" type="button"
                                                                       value="Limpiar" process="@form" 
                                                                       update=":form:formr:listapr :form:formr:acSimple24"  action="#{controladorKardex.limpiarna()}"
                                                                       styleClass="btn btn-success" >

                                                        </p:commandLink>
                                                    </center>

                                                </div>
                                            </div>

                                            <br></br>

                                            <div class="tab-content">
                                                <div class="tab-pane active" id="todas">
                                                    <div class="table-responsive">

                                                        <p:messages  id="mensajes" showDetail="true" autoUpdate="true" closable="true" />
                                                        <tbody>
                                                            <p:dataTable id="listapr" value="#{controladorKardex.listareqNoAp}" var="itemr"

                                                                         paginator="true" rows="5"                         
                                                                         paginatorPosition="top"
                                                                         rowsPerPageTemplate="5,10,15,20"
                                                                         widgetVar="requisicionTable"   emptyMessage="No se han encontrado coincidencias">
                                                                <f:facet name="header">
                                                                    Lista de requisiciones no aprobadas
                                                                </f:facet>
                                                                <p:column headerText="Número de requisición" sortBy="#{itemr.numRequisicion}" >

                                                                    <h:outputText value="#{itemr.numRequisicion}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Fecha de requisición" sortBy="#{itemr.fechaRequisicion}">
                                                                    <h:outputText value="#{controladorRequisicion.formato(itemr.fechaRequisicion)}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Observación" sortBy="#{itemr.observaciones}">
                                                                    <h:outputText value="#{itemr.observaciones}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Registro del vehículo" sortBy="#{itemr.vehiculo.numRegistro}">
                                                                    <h:outputText value="#{itemr.vehiculo.numRegistro}"></h:outputText>
                                                                </p:column>
                                                                <p:column headerText="Aprobar" style="width: 5%"> 
                                                                    <p:commandButton update=":form:formr:req :form:formr:pp2 :form:formr:saveg2 :form:formr:saveg" process="@this" title="Aprobar" icon="ui-icon-check">
                                                                        <f:setPropertyActionListener value="#{itemr}" target="#{controladorKardex.requisicion}" />

                                                                    </p:commandButton>

                                                                </p:column>
                                                            </p:dataTable> <br/>
                                                            <p:panel id="req" >
                                                                <div class="panel panel-primary">
                                                                    <div class="panel-heading"  align="center">Datos de requisición seleccionada</div>
                                                                    <p:panel >
                                                                        <div class="container-fluid" align="center">
                                                                            <div class="row-fluid"  >
                                                                                <div class="col-md-4"> 
                                                                                    <h:outputLabel class="navbar-text" value=" Número de requisición:"/>
                                                                                    <h:outputText class="navbar-text" value="#{controladorKardex.requisicion.numRequisicion}"/>

                                                                                </div>

                                                                                <div class="col-md-4"> 
                                                                                    <h:outputLabel class="navbar-text" value=" Fecha de requisición: "/>
                                                                                    <h:outputText class="navbar-text" 
                                                                                                  value="#{controladorKardex.formato(controladorKardex.requisicion.fechaRequisicion)}"/>

                                                                                </div>



                                                                            </div>
                                                                            <div class="row-fluid"  >
                                                                                <div class="col-md-4"> 
                                                                                    <h:outputLabel class="navbar-text" value=" Observación:"/>
                                                                                    <h:outputText class="navbar-text" value="#{controladorKardex.requisicion.observaciones}"/>
                                                                                </div>


                                                                            </div>
                                                                        </div>
                                                                    </p:panel>
                                                                </div>

                                                            </p:panel>
                                                        </tbody>
                                                    </div>
                                                </div>

                                                <p:panel id="pp2">
                                                    <div class="admin-actions " align="center"> 

                                                        <p:commandButton rendered="#{controladorKardex.requisicion == null}" id="saveg" value="Guardar" 
                                                                         update=":form:formr:mensajes" 
                                                                         process="@form" icon="ui-icon-disk" 
                                                                         styleClass="btn  btn-success" 
                                                                         actionListener="#{controladorKardex.guardarRequisicion()}"

                                                                         >


                                                        </p:commandButton>


                                                        <p:button rendered="#{controladorKardex.requisicion ne null}" id="saveg2"  value="Guardar" 
                                                                  styleClass="btn  btn-success" icon="ui-icon-disk" 
                                                                  outcome="/paginas/admin/kardex/crear">
                                                            <f:param name="estado" value="true"/>
                                                            <f:param name="kardexId" value="#{controladorKardex.instance.id}"/>
                                                            <f:param name="requisicionId" value="#{controladorKardex.requisicion.id}"/>
                                                            <f:param name="valorVista" value="kardex"/>



                                                        </p:button>



                                                    </div>
                                                </p:panel>
                                            </div>
                                        </h:form>
                                    </div>
                                </div>
                            </p:panel>

                        </div>


                    </p:panel>
                </div>
            </div>


            <p:dialog modal="true" header="Por favor espere, Cargando..." widgetVar="ajaxStatusDialog"  resizable="false"  draggable="false" closable="false" > 

                <p:graphicImage value="/resources/ajax-loader.gif" /> 

            </p:dialog>
        </h:form>


        <!--p:dialog id="cancel-dialog1" header="# {messages['common.delete.confirm']}" widgetVar="deletedDlg1" resizable="false" modal="true">  
            <h:form id="form-dialog-confirm-delete1">

                <h:panelGroup layout="block" style="padding:5px;">  
                    <h:outputText value="Sesea realmente dar de baja a la solicitud"/>
                    <h:outputText value="# {controladorKardex.solicitud.numSolicitud}"/>  
                </h:panelGroup>  

                <p:button id="dardebaja2" icon="ui-icon-trash"
                          title="Dar de baja"  
                          outcome="/paginas/admin/kardex/crear"  
                          >

                    <f:param name="kardexId" value="# {controladorKardex.instance.id}"/>
                    <f:param name="solicitudId" value="# {controladorKardex.solicitud.id}"/>
                    <f:param name="valorVista" value="kardex"/>
                </p:button>
                <p:commandButton value="# {messages['common.no']}" type="button" onclick="deletedDlg1.hide();"  
                                 style="margin-top:10px;"/>  

            </h:form>
        </p:dialog-->

        <p:dialog id="dia" header="Confirmación" widgetVar="dlg1"  resizable="false" modal="true">
            <h:form id="form-dialog-confirm-delete5">

                <h:panelGroup layout="block" id="dial" style="padding:5px;">  
                    <h:outputText value="Desea realmente dar de baja a la requisición "/>
                    <h:outputText value="#{controladorKardex.requisicion.numRequisicion}"/>  

                </h:panelGroup> 
                <center>
                    <p:button id="dardebaja3" value="Sí"  
                              outcome="/paginas/admin/kardex/crear"  

                              >
                        <f:param name="estado" value="false"/>
                        <f:param name="kardexId" value="#{controladorKardex.instance.id}"/>
                        <f:param name="requisicionId" value="#{controladorKardex.requisicion.id}"/>
                        <f:param name="valorVista" value="kardex"/>
                    </p:button>
                    <p:commandButton value="No" type="button" onclick="dlg1.hide();"  
                                     style="margin-top:10px;"/>  
                </center>

            </h:form>


        </p:dialog>
        <p:dialog id="dia2" header="Confirmación" widgetVar="dlg2"  resizable="false" modal="true">
            <h:form id="form-dialog-confirm-delete1" >

                <h:panelGroup layout="block" id="dial" style="padding:5px;">  
                    <h:outputText value="Desea realmente dar de baja a la solicitud de reparación y mantenimiento "/>
                    <h:outputText value="#{controladorKardex.solicitud.numSolicitud}"/>  

                </h:panelGroup> 
                <center>
                    <p:button id="dardebaja1" value="Sí"
                              outcome="/paginas/admin/kardex/crear"  

                              >
                        <f:param name="estado" value="false"/>
                        <f:param name="kardexId" value="#{controladorKardex.instance.id}"/>
                        <f:param name="solicitudId" value="#{controladorKardex.solicitud.id}"/>
                        <f:param name="valorVista" value="kardex"/>
                    </p:button>
                    <p:commandButton value="No" type="button" onclick="dlg2.hide();"  
                                     style="margin-top:10px;"/>  
                </center>

            </h:form>


        </p:dialog>
    </ui:define>
</ui:composition>
