<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"                
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:fn="http://java.sun.com/jsp/jstl/functions"
                template="/WEB-INF/templates/plantilla.xhtml"
                xmlns:mtop="http://mtop.org/jsf/facelets">

    <ui:param name="titulo" value="Mantenimiento de los vehiculos"/>

    <ui:define name="header">

        #{titulo} 

    </ui:define>
    <ui:define name="content">
        <!--Metadato que se realiza antes de renderizarse la vista-->

        <!--Formulario dentro de un contenedor-->
        <h:form id="form">            
            <div role="main">
                <div class="container-content" style="margin: 2em 10em 6em 10em; " align="left">
                    <!--Opción de mensaje, cuando se realiza una acción-->
                    <div class="panel panel-primary">
                        <p:panel>
                            <p:messages id="messages" showDetail="true" autoUpdate="true" closable="true" />  

                            <div class="row">

                                <div class="tab-content">
                                    <div class="tab-pane active" id="todas">
                                        <div class="table-responsive">
      <div class="admin-actions">
                                <div class="panel panel-success">
                                    <p:panel>
                                        <div class="panel-body">
                                            <div class="container-fluid" align="center">
                                                <div class="row-fluid">


                                                    <div class="col-lg-6">

                                                        <div class="input-group">
                                                            <center>
                                                                <h:outputLabel value="Buscar:  " />     #{' '} 

                                                                <p:autoComplete  placeholder="Criterio a buscar" styleClass="xLarge" id="acSimple" value="#{controladorVehiculo.palabrab}"   
                                                                                completeMethod="#{controladorVehiculo.autocompletar}"/> 
                                                                &nbsp;&nbsp;





                                                                <p:commandButton icon="ui-icon-search" value="Buscar" update=":form:listap" action="#{controladorVehiculo.buscar()}" styleClass="btn btn-success" >

                                                                </p:commandButton>

                                                                <p:commandButton icon="ui-icon-arrowrefresh-1-s" value="Limpiar" update=":form:listap :form:acSimple" action="#{controladorVehiculo.limpiar()}" styleClass="btn btn-success" >

                                                                </p:commandButton>
                                                            </center>
                                                        </div>


                                                    </div>
                                                </div>
                                            </div>
                                        </div> </p:panel></div>

                            
                            </div>


                                            <tbody>
                                                <p:dataTable id="listap" value="#{controladorVehiculo.listaVehiculos}" var="v" paginator="true" rows="15"                         
                                         paginatorPosition="top"
                                         rowsPerPageTemplate="5,10,15,20">
                                                    <p:column headerText="Registro" sortBy="#{v.numRegistro}">
                                                        <h:outputText value="#{v.numRegistro}"></h:outputText>

                                                    </p:column>
                                                    <p:column headerText="Kilometraje Actual" sortBy="#{v.kilometraje}">
                                                        <h:outputText value="#{v.kilometraje}"></h:outputText>
                                                    </p:column>
                                                    <p:column headerText="Próximo Kilometraje" >
                                                        <h:outputText value="#{controladorVehiculo.obtenerKilometraje(v.kilometraje)}"></h:outputText>
                                                    </p:column>
                                                    <p:column headerText="Observación" sortBy="#{v.description}">
                                                        <h:outputText value="#{v.description}"></h:outputText>
                                                    </p:column>
                                                    <p:column headerText="Opciones" style="width: 5%"> 
                                                        <h:link value="Cambiar Kilometraje" outcome="cambiarKilometraje" type="button" >
                                                            <f:param name="vehiculoId" value="#{v.id}"></f:param>
                                                        </h:link>
                                                        &nbsp;&nbsp;
                                                     
                                                        <p:commandButton id="visualizar1" icon="ui-icon-search" oncomplete="#{'carDialog.show();'}" immediate="true" actionListener="#{controladorVehiculo.vizualizarActividades(v.id)}"  title="Visualizar" disabled="#{controladorVehiculo.verificarPlan() eq false}">
                                                            <p:ajax process="@this" update=":form-dialog :form:messages"/> 
                                                        </p:commandButton>
                                                    </p:column>
                                                </p:dataTable>
                                            </tbody>

                                        </div>
                                    </div>
                                </div>
                            </div>

                        </p:panel>  </div></div></div>


            <p:dialog id="dialog" header="Detalles del Vehículo" showEffect="fade" widgetVar="documentDialog" modal="true" resizable="false">

                <p:panelGrid  columns="2" columnClasses="label,value" rendered="#{not empty controladorVehiculo.instance}">
                    <h:outputLabel for="name" value="Numero de Registro: " />
                    <h:outputText id="name" value="#{controladorVehiculo.instance.numRegistro}" style="font-weight:bold" />

                    <h:outputLabel for="marca" value="Marca: " />
                    <h:outputText id="marca" value="#{controladorVehiculo.instance.marca}" style="font-weight:bold" />


                </p:panelGrid>
   <p:commandButton title="Imprimir" icon="ui-ribbonicon-print" type="button" >  
                        <p:printer target=":form-dialog" />  
                    </p:commandButton>
            </p:dialog>

        </h:form>


        <p:dialog id="form-dialog" header="Actividades por kilometraje " widgetVar="carDialog"  modal="true" resizable="true" dynamic="true" width="550">
            <h:form id="v"  >
                <div class="container-fluid">
                                <div class="row-fluid"  >
                <p:messages id="msg" showDetail="true" autoUpdate="true" closable="true" />  
                
                <h:outputLabel for="k" value="Kilometraje: " />
                <h:outputText id="k" value="#{controladorVehiculo.actividadplan.kilometraje}"  style="font-weight:bold" /><br/>
                <h:outputLabel id="act" value="Actividades: " /><br/>
                <h:inputTextarea  value="#{controladorVehiculo.actividadplan.actividad}" style="font-weight:bold" disabled="true"/>
                
                </div></div>
                 <div class="admin-actions " align="center" > 
                    <!--p:commandButton title="Imprimir" icon="ui-ribbonicon-print" type="button" >  
                        <p:printer target=":form-dialog" />  
                    </p:commandButton-->
                    <h:commandLink value="Imprimir" type="link" >  
                        <p:printer target=":form-dialog" />  
                    </h:commandLink>

                    &nbsp;&nbsp;
                    <p:button value="Regresar" icon="ui-icon-arrowreturnthick-1-w"  rendered="#{true}" outcome="/paginas/admin/vehiculo/mantenimientoVehiculo/lista" styleClass="btn  btn-success">

                    </p:button>
                 </div>
            </h:form>
        </p:dialog>

    </ui:define>
</ui:composition>



